#!/bin/bash
#
# This script prepares the tix-cli dependencies and starts it.

set -e

#PATHs
readonly INSTALL_ROOT=$HOME
readonly CONFIG_PATH="$INSTALL_ROOT/.tixrc"
readonly MODULE_ROOT="$INSTALL_ROOT/tixinc"
readonly CLI_ROOT="$MODULE_ROOT/tix-cli"
readonly CLI_PATH="$MODULE_ROOT/tix-cli/tix-cli.js"

$(npm-authenticate) 2>&1
GITHUB_TOKEN=$(github-token)

if [ ! -e $CLI_PATH ]; then
  $(install-cli)
fi

echo Executing CLI at $CLI_PATH...
node "$CLI_PATH" "$GITHUB_TOKEN"