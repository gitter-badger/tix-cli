#!/bin/bash
#
# Clones the specified module to a directory in the modules installation root

readonly INSTALL_ROOT=$HOME
readonly MODULE_ROOT="${INSTALL_ROOT}/tixinc"

readonly GITHUB_URL_BASE=https://$(github-token)@github.com
readonly GITHUB_URL_TIX="${GITHUB_URL_BASE}/TixInc"

### if no arguments, throw an error
if [ $# -eq 1 ]; then
  >&2 echo Must specify a module to clone...
  exit 1
fi

module_name=$1
module_dir=${2-$module_name}
module_path="~/tixinc/$module_dir"
module_url="$GITHUB_URL_TIX/$module_name"

### if module already cloned, throw an error
if [ -d $module_path ]; then
  >&2 echo Module $module_name already exists at $module_path...
  exit 1
fi

>&2 echo cloning $module_url to $module_path...

git clone $module_url $module_path | grep -qi "fatal" && >&2 echo "An error occurred while cloning." && exit 1

>&2 echo $module_name cloned successfully.