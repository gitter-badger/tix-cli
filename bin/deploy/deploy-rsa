#!/bin/bash
#
# Deploys fresh tixinc-js artifacts

set -e

. "$HOME/.tixrc"

### if no arguments, throw an error
if [ $# -lt 1 ]; then
  >&2 echo -e "${RED}--Must specify a configuration to deploy...--${NC}"
  exit 1
fi

configuration="$1"
rsa_file_path="$ARTIFACTS_ROOT/register-$(echo $configuration | tr '[:upper:]' '[:lower:]')-rsa.cmd"

>&2 echo "--Deploying rsa script--"
rimraf "$rsa_file_path"
echo "aspnet_regiis -pi \"${configuration}Keys\" \".\${configuration}Keys.xml\"\r\naspnet_regiis -pa \"${configuration}Keys\" \"NT Authority\Network Service\"" >"$rsa_file_path"
>&2 echo -e "${GREEN}--rsa script successfully deployed--${NC}"